---
title: 迪菲-赫尔曼密钥交换
tags:
  - Python
  - 算法
categories: 算法
abbrlink: de8de911
date: 2017-12-04 19:44:39
---

__迪菲-赫尔曼密钥交换__（英语：Diffie–Hellman key exchange，缩写为D-H） 是一种安全协议(ps：不是加密算法)。它可以让双方在完全没有对方任何预先信息的条件下通过不安全信道创建起一个密钥。这个密钥可以在后续的通讯中作为对称密钥来加密通讯内容。
<!-- more -->

![](DH.png)

最简单，最早提出的这个协议使用一个质数p的整数模n乘法群以及其原根g。

算法如下，绿色表示非秘密信息, 红色粗体表示秘密信息：
1. 爱丽丝与鲍伯协定使用 p=23以及base g=5.
2. 爱丽丝选择一个秘密整数a=6, 计算A = ga mod p并发送给鲍伯。
    $$A = 56 mod 23 = 8$$
3. 鲍伯选择一个秘密整数b=15, 计算B = gb mod p并发送给爱丽丝。
    $$B = 515 mod 23 = 19$$
4. 爱丽丝计算s = B a mod p
    $$196 mod 23 = 2$$
5. 鲍伯计算s = A b mod p
    $$815 mod 23 = 2$$

爱丽丝和鲍伯最终都得到了同样的值，因为在模p下 $g^{ab}$$g^{ab}$和 $g^{ba}$ $g^{ba}$ 相等。 注意a, b 和 gab = gba mod p 是秘密的。 其他所有的值p, g, $ga modp$, 以及 gb mod p都可以在公共信道上传递。

一旦爱丽丝和鲍伯得出了公共秘密，他们就可以把它用作对称密钥，以进行双方的加密通讯，因为这个密钥只有他们才能得到。

当然，为了使这个例子变得安全，必须使用非常大的a, b 以及 p， 否则可以实验所有$g^{ab} mod 23 $的可能取值(总共有最多22个这样的值, 就算a和b很大也无济于事)。 如果 p 是一个至少 300 位的质数，并且a和b至少有100位长， 那么即使使用全人类所有的计算资源和当今最好的算法也不可能从g, p和$ga \bmod p$ 中计算出 a。这个问题就是著名的离散对数问题。注意g则不需要很大, 并且在一般的实践中通常是2或者5

以下是一个更为一般的描述:
1. 爱丽丝和鲍伯写上一个有限循环群 G 和它的一个生成元 g。 （这通常在协议开始很久以前就已经规定好； g是公开的，并可以被所有的攻击者看到。）
2. 爱丽丝选择一个随机自然数 a 并且将 $g^{a} mod p$发送给鲍伯。
3. 鲍伯选择一个随机自然数 b 并且将$g^{b} mod p$发送给爱丽丝。
4. 爱丽丝 计算 $(g^{b})^{a} mod p$。
5. 鲍伯 计算 $(g^{a})^{b} mod p$。

爱丽丝和鲍伯就同时协商出群元素$g^{ab}$，它可以被用作共享秘密。$(g^{b})^{a}$和 $(g^{a})^{b}$因为群是乘法交换的。
